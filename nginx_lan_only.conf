# 后台管理仅限局域网访问配置
# 添加到现有的 Nginx 配置中

# ==================== 前台网站 - 公开访问 ====================
location / {
    try_files $uri $uri/ /index.html;
    # 所有公网用户都可以访问前台
}

# ==================== 后台管理 - 仅限局域网 ====================
location /admin.html {
    # 允许局域网IP (根据您的网络调整)
    # 常见局域网范围：
    # - 192.168.1.0/24   (家用路由器)
    # - 10.0.0.0/8       (企业网络)
    # - 172.16.0.0/12    (企业网络)

    # 示例：允许 192.168.1.x 网段
    allow 192.168.1.0/24;

    # 如果您使用其他网段，取消相应注释：
    # allow 10.0.0.0/8;
    # allow 172.16.0.0/12;

    # 允许本地回环地址（服务器自己访问）
    allow 127.0.0.1;
    allow ::1;

    # 拒绝所有其他IP（公网访问）
    deny all;

    # 可选：添加Basic Auth密码保护
    # auth_basic "Admin Area";
    # auth_basic_user_file /etc/nginx/.htpasswd;

    try_files $uri $uri/ /index.html;
}

# ==================== 后台相关路径 ====================
location ~ ^/(admin|api/admin|dashboard) {
    allow 192.168.1.0/24;
    allow 127.0.0.1;
    allow ::1;
    deny all;
}

# ==================== 静态资源 - 公开访问 ====================
location ~* \.(css|js|images|fonts|ico)$ {
    # 静态资源对所有人开放（包括后台需要的资源）
    expires 1y;
    add_header Cache-Control "public, immutable";
}
